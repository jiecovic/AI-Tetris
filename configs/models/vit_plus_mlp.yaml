model:

  policy_kwargs:
    net_arch: [512]
    activation_fn: GELU   # or whatever mapping you use


  feature_extractor:

    spatial_preprocessor:
      type: binary                 # options: binary (later RGB)
      params: {}                   # binary: no params


#    stem:
#      type: conv1x3_32x4_64_5l                     # options: none | cnn | conv3x3_32_32_64
#      type: conv3x3_32_32_64                     # options: none | cnn | conv3x3_32_32_64

      # ------------------------------------------------------------------
      # if type: conv3x3_32_32_64 (fixed preset, no tuning knobs)
      # ------------------------------------------------------------------
      # params: {}                   # preset-defined architecture

      # ------------------------------------------------------------------
      # if type: cnn (generic configurable CNN stem)
      # ------------------------------------------------------------------
      # params:
      #   channels: [32, 32, 64]     # options: list[int], out_channels per conv layer
      #   kernel_size: 3             # options: int > 0 (usually 3)
      #   stride: 1                  # options: int > 0
      #   padding: same              # options: valid | same | tetris
      #   activation: relu           # options: relu | gelu | identity
      #   dropout: 0.0               # options: float >= 0
      #   use_batchnorm: false       # options: true | false (NOT RL-friendly)


    encoder:
      type: token  # token | spatial

      # ------------------------------------------------------------------
      # token encoder (used when type: token_encoder)
      # ------------------------------------------------------------------

      tokenizer:
        d_model: 256                                 # options: int > 0
        add_active_token: true
        add_next_token: true
        share_kind_embedding: true
        layout:
          type: row_column                # options: row | column | patch | row_column
          params: {}               # patch: patch_h, patch_w, stride_h, stride_w

        board_embedding:
          type: conv1d                                   # options: conv1d | linear | discrete_pattern
          params:
            preset: deep_l5                                 # options: tiny | base | deep | generic
            dropout: 0.0                                 # options: float >= 0
            padding: tetris                               # options: valid | same | tetris
            coordconv: true

  #      board_embedding:
  #        type: conv1d                                   # options: conv1d
  #        params:
  #          d_model: 256                                 # options: int > 0
  #          preset: generic                              # options: tiny | base | deep | generic
  #          dropout: 0.0                                 # options: float >= 0
  #          padding: same                                # options: valid | same | tetris
  #          channels: [ 128, 256 ]                         # options: list[int] (required if preset=generic)
  #          kernel_sizes: [ 3, 3 ]                         # options: list[int] (required if preset=generic)
  #          strides: [ 1, 1 ]                              # options: list[int] (optional; default all 1 if omitted)
  #          activation: gelu                             # options: gelu | relu | silu
  #          use_batchnorm: false                         # options: true | false

      mixer:
        type: transformer          # options: transformer | mlp
        params:
          features_dim: 256        # final projected dim after pooling
          n_layers: 4              # options: int > 0
          n_heads: 4               # options: int > 0
          mlp_ratio: 4.0           # options: float > 0
          dropout: 0.01             # options: float >= 0
          attn_dropout: 0.0        # options: float >= 0
          resid_dropout: 0.0       # options: float >= 0
          use_cls: true            # options: true | false
          num_cls_tokens: 1        # options: int > 0 (if use_cls)
          pool: mean                # options: cls | cls_mean | cls_max | cls_meanmax | mean | max | meanmax | flatten
          pre_ln_input: true      # options: true | false

  #  encoder:
  #    type: spatial_encoder          # options: token_encoder | spatial_encoder

      # ------------------------------------------------------------------
      # spatial encoder (used when type: spatial_encoder)
      # ------------------------------------------------------------------

      # spatial_head:
      #   type: global_pool        # options: global_pool | flatten_mlp | col_collapse | attn_pool
      #   params:
      #     out_dim: 256           # options: int > 0
      #     pooling: mean          # options: mean | max | meanmax (if applicable)

    feature_augmenter:
      type: null               # options: null | onehot_concat | mlp_joint | mlp_split
#      params:
##        use_active: true        # include one-hot of active piece kind
###        use_next: true          # include one-hot(s) of next queue
